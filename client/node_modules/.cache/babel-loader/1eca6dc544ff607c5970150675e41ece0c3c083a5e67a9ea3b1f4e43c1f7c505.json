{"ast":null,"code":"// client/src/components/messages/MessageInput.js\nimport React,{useState,useRef}from'react';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const MessageInput=_ref=>{let{onSendMessage,conversationId}=_ref;const[message,setMessage]=useState('');const[isUploading,setIsUploading]=useState(false);const[uploadPreview,setUploadPreview]=useState(null);const[uploadFile,setUploadFile]=useState(null);const fileInputRef=useRef(null);// Handle text input change\nconst handleInputChange=e=>{setMessage(e.target.value);};// Handle form submission\nconst handleSubmit=e=>{e.preventDefault();if(message.trim()===''&&!uploadFile)return;if(uploadFile){// Send message with media\nonSendMessage(message.trim(),'media',uploadFile);}else{// Send text message\nonSendMessage(message.trim());}// Reset form\nsetMessage('');setUploadPreview(null);setUploadFile(null);};// Handle key press events\nconst handleKeyPress=e=>{// Send message on Enter (without Shift)\nif(e.key==='Enter'&&!e.shiftKey){e.preventDefault();handleSubmit(e);}};// Handle file selection\nconst handleFileSelect=e=>{const file=e.target.files[0];if(!file)return;// Check file size (10MB max)\nconst maxSize=10*1024*1024;// 10MB\nif(file.size>maxSize){alert('File is too large. Maximum size is 10MB.');return;}setUploadFile(file);// Create preview for images\nif(file.type.startsWith('image/')){const reader=new FileReader();reader.onload=e=>{setUploadPreview(e.target.result);};reader.readAsDataURL(file);}else{// For non-image files, just show the filename\nsetUploadPreview(file.name);}};// Trigger file input click\nconst openFileSelector=()=>{fileInputRef.current.click();};// Cancel upload\nconst cancelUpload=()=>{setUploadPreview(null);setUploadFile(null);// Reset the file input\nfileInputRef.current.value=null;};return/*#__PURE__*/_jsxs(\"div\",{className:\"message-input-container\",children:[uploadPreview&&/*#__PURE__*/_jsxs(\"div\",{className:\"upload-preview\",children:[typeof uploadPreview==='string'&&uploadPreview.startsWith('data:image')?/*#__PURE__*/_jsx(\"div\",{className:\"image-preview\",children:/*#__PURE__*/_jsx(\"img\",{src:uploadPreview,alt:\"Upload preview\"})}):/*#__PURE__*/_jsxs(\"div\",{className:\"file-preview\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-file\"}),/*#__PURE__*/_jsx(\"span\",{children:uploadPreview})]}),/*#__PURE__*/_jsx(\"button\",{className:\"cancel-upload\",onClick:cancelUpload,\"aria-label\":\"Cancel upload\",children:/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-times\"})})]}),/*#__PURE__*/_jsxs(\"form\",{className:\"message-form\",onSubmit:handleSubmit,children:[/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"attachment-button\",onClick:openFileSelector,\"aria-label\":\"Attach file\",children:/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-paperclip\"})}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",ref:fileInputRef,onChange:handleFileSelect,style:{display:'none'},accept:\"image/*,application/pdf,application/msword,application/vnd.openxmlformats-officedocument.wordprocessingml.document,application/vnd.ms-excel,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,application/vnd.ms-powerpoint,application/vnd.openxmlformats-officedocument.presentationml.presentation,text/plain\"}),/*#__PURE__*/_jsx(\"textarea\",{className:\"message-input\",placeholder:\"Type a message...\",value:message,onChange:handleInputChange,onKeyPress:handleKeyPress,disabled:isUploading}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"send-button\",disabled:message.trim()===''&&!uploadFile,\"aria-label\":\"Send message\",children:/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-paper-plane\"})})]})]});};export default MessageInput;","map":{"version":3,"names":["React","useState","useRef","jsx","_jsx","jsxs","_jsxs","MessageInput","_ref","onSendMessage","conversationId","message","setMessage","isUploading","setIsUploading","uploadPreview","setUploadPreview","uploadFile","setUploadFile","fileInputRef","handleInputChange","e","target","value","handleSubmit","preventDefault","trim","handleKeyPress","key","shiftKey","handleFileSelect","file","files","maxSize","size","alert","type","startsWith","reader","FileReader","onload","result","readAsDataURL","name","openFileSelector","current","click","cancelUpload","className","children","src","alt","onClick","onSubmit","ref","onChange","style","display","accept","placeholder","onKeyPress","disabled"],"sources":["C:/Users/user/academy-portal-test/client/src/components/messages/MessageInput.js"],"sourcesContent":["// client/src/components/messages/MessageInput.js\r\nimport React, { useState, useRef } from 'react';\r\n\r\nconst MessageInput = ({ onSendMessage, conversationId }) => {\r\n  const [message, setMessage] = useState('');\r\n  const [isUploading, setIsUploading] = useState(false);\r\n  const [uploadPreview, setUploadPreview] = useState(null);\r\n  const [uploadFile, setUploadFile] = useState(null);\r\n  const fileInputRef = useRef(null);\r\n  \r\n  // Handle text input change\r\n  const handleInputChange = (e) => {\r\n    setMessage(e.target.value);\r\n  };\r\n  \r\n  // Handle form submission\r\n  const handleSubmit = (e) => {\r\n    e.preventDefault();\r\n    \r\n    if (message.trim() === '' && !uploadFile) return;\r\n    \r\n    if (uploadFile) {\r\n      // Send message with media\r\n      onSendMessage(message.trim(), 'media', uploadFile);\r\n    } else {\r\n      // Send text message\r\n      onSendMessage(message.trim());\r\n    }\r\n    \r\n    // Reset form\r\n    setMessage('');\r\n    setUploadPreview(null);\r\n    setUploadFile(null);\r\n  };\r\n  \r\n  // Handle key press events\r\n  const handleKeyPress = (e) => {\r\n    // Send message on Enter (without Shift)\r\n    if (e.key === 'Enter' && !e.shiftKey) {\r\n      e.preventDefault();\r\n      handleSubmit(e);\r\n    }\r\n  };\r\n  \r\n  // Handle file selection\r\n  const handleFileSelect = (e) => {\r\n    const file = e.target.files[0];\r\n    \r\n    if (!file) return;\r\n    \r\n    // Check file size (10MB max)\r\n    const maxSize = 10 * 1024 * 1024; // 10MB\r\n    if (file.size > maxSize) {\r\n      alert('File is too large. Maximum size is 10MB.');\r\n      return;\r\n    }\r\n    \r\n    setUploadFile(file);\r\n    \r\n    // Create preview for images\r\n    if (file.type.startsWith('image/')) {\r\n      const reader = new FileReader();\r\n      reader.onload = (e) => {\r\n        setUploadPreview(e.target.result);\r\n      };\r\n      reader.readAsDataURL(file);\r\n    } else {\r\n      // For non-image files, just show the filename\r\n      setUploadPreview(file.name);\r\n    }\r\n  };\r\n  \r\n  // Trigger file input click\r\n  const openFileSelector = () => {\r\n    fileInputRef.current.click();\r\n  };\r\n  \r\n  // Cancel upload\r\n  const cancelUpload = () => {\r\n    setUploadPreview(null);\r\n    setUploadFile(null);\r\n    // Reset the file input\r\n    fileInputRef.current.value = null;\r\n  };\r\n  \r\n  return (\r\n    <div className=\"message-input-container\">\r\n      {uploadPreview && (\r\n        <div className=\"upload-preview\">\r\n          {typeof uploadPreview === 'string' && uploadPreview.startsWith('data:image') ? (\r\n            <div className=\"image-preview\">\r\n              <img src={uploadPreview} alt=\"Upload preview\" />\r\n            </div>\r\n          ) : (\r\n            <div className=\"file-preview\">\r\n              <i className=\"fas fa-file\"></i>\r\n              <span>{uploadPreview}</span>\r\n            </div>\r\n          )}\r\n          <button \r\n            className=\"cancel-upload\"\r\n            onClick={cancelUpload}\r\n            aria-label=\"Cancel upload\"\r\n          >\r\n            <i className=\"fas fa-times\"></i>\r\n          </button>\r\n        </div>\r\n      )}\r\n      \r\n      <form className=\"message-form\" onSubmit={handleSubmit}>\r\n        <button\r\n          type=\"button\"\r\n          className=\"attachment-button\"\r\n          onClick={openFileSelector}\r\n          aria-label=\"Attach file\"\r\n        >\r\n          <i className=\"fas fa-paperclip\"></i>\r\n        </button>\r\n        \r\n        <input\r\n          type=\"file\"\r\n          ref={fileInputRef}\r\n          onChange={handleFileSelect}\r\n          style={{ display: 'none' }}\r\n          accept=\"image/*,application/pdf,application/msword,application/vnd.openxmlformats-officedocument.wordprocessingml.document,application/vnd.ms-excel,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,application/vnd.ms-powerpoint,application/vnd.openxmlformats-officedocument.presentationml.presentation,text/plain\"\r\n        />\r\n        \r\n        <textarea\r\n          className=\"message-input\"\r\n          placeholder=\"Type a message...\"\r\n          value={message}\r\n          onChange={handleInputChange}\r\n          onKeyPress={handleKeyPress}\r\n          disabled={isUploading}\r\n        />\r\n        \r\n        <button\r\n          type=\"submit\"\r\n          className=\"send-button\"\r\n          disabled={message.trim() === '' && !uploadFile}\r\n          aria-label=\"Send message\"\r\n        >\r\n          <i className=\"fas fa-paper-plane\"></i>\r\n        </button>\r\n      </form>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default MessageInput;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}